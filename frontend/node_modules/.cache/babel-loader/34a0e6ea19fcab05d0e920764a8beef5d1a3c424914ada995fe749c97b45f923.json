{"ast":null,"code":"var _jsxFileName = \"/home/node/app/src/Chat.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { useState, useEffect } from \"react\";\nimport { Help, MuteList, BlockList } from \"./other\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction Chat({\n  props\n}) {\n  const getWhisp = text => {\n    if (!text[2] || text[2] !== ' ') return undefined;\n    let nameStart = text.indexOf('\"', 3);\n    if (nameStart < 0) return undefined;\n    let nameEnd = text.indexOf('\"', nameStart + 1);\n    if (nameEnd < 0) return undefined;\n    let name = text.substring(nameStart + 1, nameEnd);\n    if (name.trim() === '') return undefined;\n    if (!text[nameEnd + 1] || text[nameEnd + 1] !== ' ') return undefined;\n    let txt = text.substr(nameEnd + 2);\n    if (txt.trim() === '') return undefined;\n    return {\n      type: 'whisp',\n      target: name,\n      myId: props.myProfile.id,\n      name: props.myProfile.name,\n      text: txt\n    };\n  };\n  const isSpecialCommand = text => {\n    let command = text.substr(0, 2);\n    if (command === '/h' || command === '/m' || command === '/b') {\n      if (text[2] && text.substr(2).trim() !== command) props.setChats(props.chats.map(chat => {\n        if (chat.tag === props.chanTag) return {\n          ...chat,\n          messages: [...chat.messages, {\n            type: 'system',\n            text: 'Wrong command. Use : ' + command\n          }]\n        };else return chat;\n      }));else if (command === '/h') props.setChats(props.chats.map(chat => {\n        if (chat.tag === props.chanTag) return {\n          ...chat,\n          messages: [...chat.messages.filter(message => message.type !== 'help'), {\n            type: 'help'\n          }]\n        };else return chat;\n      }));else if (command === '/m') props.setChats(props.chats.map(chat => {\n        if (chat.tag === props.chanTag) return {\n          ...chat,\n          messages: [...chat.messages.filter(message => message.type !== 'mute'), {\n            type: 'mute'\n          }]\n        };else return chat;\n      }));else if (command === '/b') props.setChats(props.chats.map(chat => {\n        if (chat.tag === props.chanTag) return {\n          ...chat,\n          messages: [...chat.messages.filter(message => message.type !== 'block'), {\n            type: 'block'\n          }]\n        };else return chat;\n      }));\n      document.getElementById('chatPrompt').value = '';\n      return true;\n    }\n    if (command === '/w') {\n      let message = getWhisp(text);\n      if (!message) {\n        props.setChats(props.chats.map(chat => {\n          if (chat.tag === props.chanTag) return {\n            ...chat,\n            messages: [...chat.messages, {\n              type: 'system',\n              text: 'Wrong command. Use : /w \"[username]\" [message]'\n            }]\n          };else return chat;\n        }));\n        document.getElementById('chatPrompt').value = '';\n      } else {\n        props.setChats(props.chats.map(chat => {\n          return {\n            ...chat,\n            messages: [...chat.messages, {\n              ...message,\n              id: props.myProfile.id\n            }]\n          };\n        }));\n        // console.log(message.target)\n        document.getElementById('chatPrompt').value = '/w \"' + message.target + '\" ';\n      }\n      //sendMessage\n      return true;\n    }\n    return false;\n  };\n  const sendMessage = () => {\n    let prompt = document.getElementById('chatPrompt').value;\n    if (!isSpecialCommand(prompt)) {\n      let message = {\n        type: 'message',\n        target: props.chanTag,\n        myId: props.myProfile.id,\n        name: props.myProfile.name,\n        text: prompt\n      };\n      //sendMessage\n      props.setChats(props.chats.map(chat => {\n        if (chat.tag === props.chanTag) return {\n          ...chat,\n          messages: [...chat.messages, message]\n        };else return chat;\n      }));\n      document.getElementById('chatPrompt').value = '';\n    }\n  };\n  const toggleChan = e => {\n    props.setChanTag(e.target.dataset.tag);\n    props.setChanName(e.target.dataset.name);\n  };\n  const leaveChan = e => {\n    let tag = e.target.dataset.tag;\n    props.setChats(props.chats.filter(chat => chat.tag !== tag));\n    if (props.chanTag === tag) {\n      props.setChanTag('lobby');\n      props.setChanName('general');\n    }\n  };\n  const captureKey = e => e.keyCode === 13 && sendMessage();\n  let chanIndex = 1;\n  let leaveIndex = 1;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `h-100 ${props.xlg ? 'bg-dark-subtle' : 'bg-white'} d-flex flex-column`,\n    style: {\n      width: '300px',\n      maxHeight: '100%'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-flex justify-content-center py-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        className: \"nav-link\",\n        \"data-bs-toggle\": \"dropdown\",\n        children: /*#__PURE__*/_jsxDEV(\"h5\", {\n          className: \"my-0 text-capitalize\",\n          children: [/*#__PURE__*/_jsxDEV(\"i\", {\n            children: \"#\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 123\n          }, this), \" \", props.chanName, \" \", props.chats.length > 1 && /*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"/images/caret-down-fill.svg\",\n            alt: \"\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 176\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 86\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"dropdown-menu\",\n        children: [props.chats.map(chat => /*#__PURE__*/_jsxDEV(\"li\", {\n          onClick: toggleChan,\n          \"data-tag\": chat.tag,\n          \"data-name\": chat.name,\n          type: \"button\",\n          className: \"px-2 fw-bold dropdown-item nav-link text-capitalize\",\n          children: chat.name\n        }, chat.tag, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 7\n        }, this)), props.chats.length > 1 && /*#__PURE__*/_jsxDEV(\"li\", {\n          children: /*#__PURE__*/_jsxDEV(\"hr\", {\n            className: \"dropdown-divider\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 37\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 33\n        }, this), props.chats.length > 1 && props.chats.map(chat => /*#__PURE__*/_jsxDEV(\"li\", {\n          onClick: leaveChan,\n          \"data-tag\": chat.tag,\n          type: \"button\",\n          className: \"px-2 fw-bold dropdown-item nav-link text-capitalize\",\n          hidden: chat.tag === 'lobby',\n          children: [\"Leave \", chat.name]\n        }, chanIndex++, true, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 8\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"hr\", {\n      className: \"mx-5 mt-0 mb-2\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"px-2 d-flex flex-column justify-content-end overflow-y-auto flex-grow-1\",\n      style: {\n        maxWidth: '100%'\n      },\n      children: props.chats.map(chat => {\n        return /*#__PURE__*/_jsxDEV(Channel, {\n          props: props,\n          chat: chat\n        }, leaveIndex++, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 13\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-100 ps-4 pe-5 pb-3 pt-2 align-self-end\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-flex gap-3 pt-1 row ps-3\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"input-group p-0 m-0\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"pt-1 me-2 m-0 border-0\",\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: \"/images/wechat.svg\",\n              alt: \"\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 153,\n              columnNumber: 66\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 153,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            onKeyDown: captureKey,\n            type: \"text\",\n            name: \"chatPrompt\",\n            id: \"chatPrompt\",\n            className: `form-control ${props.xlg ? 'border-0' : 'border-1 border-black'} rounded`,\n            placeholder: props.myProfile ? 'Say something nice' : 'Log in to chat',\n            disabled: !props.myProfile || props.chats[0].messages.length > 0 && props.chats[0].messages[props.chats[0].messages.length - 1].type === 'error'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 154,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: sendMessage,\n            className: \"pt-1 ms-2 nav-link\",\n            disabled: !props.myProfile || props.chats[0].messages.length > 0 && props.chats[0].messages[props.chats[0].messages.length - 1].type === 'error',\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: \"/images/send.svg\",\n              alt: \"\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 155,\n              columnNumber: 234\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 129,\n    columnNumber: 9\n  }, this);\n}\n_c = Chat;\nfunction Menu({\n  props,\n  id,\n  name\n}) {\n  _s();\n  const [profile, setProfile] = useState(undefined);\n  if (!profile || profile.id !== id) {\n    let xhr = new XMLHttpRequest();\n    xhr.open('GET', '/aapi/user/' + id + '.json');\n    xhr.onreadystatechange = () => {\n      if (xhr.readyState === 3) setProfile({\n        id: id,\n        status: JSON.parse(xhr.response).profile.status\n      });\n    };\n    xhr.send();\n    return undefined;\n  }\n  const seeProfile = () => {\n    props.setProfileId(id);\n    props.setPage('Profile');\n  };\n  const directMessage = () => {\n    let prompt = document.getElementById('chatPrompt');\n    prompt.value = '/w '.concat('\"', name, '\" ');\n    prompt.focus();\n  };\n  const mute = () => props.setMuted([...props.muted, id]);\n  const addFriend = () => {\n    // var request = new XMLHttpRequest()\n    // request.responseType = 'json'\n    // request.open('POST', '/api/user/' + props.myProfile.id + '/addFriend/' + id, true, props.creds.name, props.creds.password)\n    // request.send()\n    // request.onload = () => {}\n    props.setMyProfile({\n      ...props.myProfile,\n      friends: [...props.myProfile.friends, id]\n    });\n  };\n  const unfriend = e => {\n    // var request = new XMLHttpRequest()\n    // request.responseType = 'json'\n    // request.open('POST', '/api/user/' + props.myProfile.id + '/removeFriend/' + id, true, props.creds.name, props.creds.password)\n    // request.send()\n    // request.onload = () => {}\n    props.setMyProfile({\n      ...props.myProfile,\n      friends: props.myProfile.friends.filter(friend => friend !== id)\n    });\n  };\n  let index = 1;\n  let menu = [/*#__PURE__*/_jsxDEV(\"li\", {\n    className: \"px-2\",\n    children: name\n  }, index++, false, {\n    fileName: _jsxFileName,\n    lineNumber: 217,\n    columnNumber: 3\n  }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n    children: /*#__PURE__*/_jsxDEV(\"hr\", {\n      className: \"dropdown-divider\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 21\n    }, this)\n  }, index++, false, {\n    fileName: _jsxFileName,\n    lineNumber: 218,\n    columnNumber: 3\n  }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n    onClick: seeProfile,\n    type: \"button\",\n    className: \"px-2 dropdown-item nav-link\",\n    children: \"See profile\"\n  }, index++, false, {\n    fileName: _jsxFileName,\n    lineNumber: 219,\n    columnNumber: 3\n  }, this)];\n  if (props.myProfile) {\n    menu.push( /*#__PURE__*/_jsxDEV(\"li\", {\n      onClick: mute,\n      type: \"button\",\n      className: \"px-2 dropdown-item nav-link\",\n      children: \"Mute\"\n    }, index++, false, {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 13\n    }, this));\n    if (!props.myProfile.friends.includes(id)) menu.push( /*#__PURE__*/_jsxDEV(\"li\", {\n      onClick: addFriend,\n      type: \"button\",\n      className: \"px-2 dropdown-item nav-link\",\n      children: \"Add to friendlist\"\n    }, index++, false, {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 14\n    }, this));else menu.push( /*#__PURE__*/_jsxDEV(\"li\", {\n      onClick: unfriend,\n      type: \"button\",\n      className: \"px-2 dropdown-item nav-link\",\n      children: \"Remove from friendlist\"\n    }, index++, false, {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 14\n    }, this));\n    if (profile.status === 'online') {\n      menu.push( /*#__PURE__*/_jsxDEV(\"li\", {\n        onClick: directMessage,\n        type: \"button\",\n        className: \"px-2 dropdown-item nav-link\",\n        children: \"Direct message\"\n      }, index++, false, {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 14\n      }, this));\n      if (!props.myProfile['pong'].challenged.includes(id)) menu.push( /*#__PURE__*/_jsxDEV(\"li\", {\n        type: \"button\",\n        className: \"px-2 dropdown-item nav-link\",\n        children: \"Challenge to Pong\"\n      }, index++, false, {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 15\n      }, this));\n      if (!props.myProfile['chess'].challenged.includes(id)) menu.push( /*#__PURE__*/_jsxDEV(\"li\", {\n        type: \"button\",\n        className: \"px-2 dropdown-item nav-link\",\n        children: \"Challenge to Chess\"\n      }, index++, false, {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 15\n      }, this));\n    }\n  }\n  return menu;\n}\n_s(Menu, \"qMT9cctcw26XLLyMqsz2jSDjxjI=\");\n_c2 = Menu;\nexport function Channel({\n  props,\n  chat\n}) {\n  _s2();\n  const [menu, setMenu] = useState(undefined);\n  useEffect(() => {\n    const interval = setInterval(() => {\n      if (chat.autoScroll) document.getElementById(chat.tag).scrollTop = document.getElementById(chat.tag).scrollHeight;\n    }, 1000);\n    return () => clearInterval(interval);\n  });\n  const unScroll = () => props.setChats(props.chats.map(item => {\n    if (item.tag === chat.tag) return {\n      ...item,\n      autoScroll: false\n    };else return item;\n  }));\n  const toBottom = () => {\n    document.getElementById(chat.tag).scrollTop = document.getElementById(chat.tag).scrollHeight;\n    props.chats.map(item => {\n      if (item.tag === chat.tag) return {\n        ...item,\n        autoScroll: true\n      };else return item;\n    });\n  };\n  const buildMenu = e => setMenu( /*#__PURE__*/_jsxDEV(Menu, {\n    props: props,\n    id: parseInt(e.target.dataset.id, 10),\n    name: e.target.dataset.name\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 270,\n    columnNumber: 35\n  }, this));\n  if (chat.messages.length > 0 && chat.messages[chat.messages.length - 1].type === 'error') return /*#__PURE__*/_jsxDEV(\"div\", {\n    hidden: props.chanTag !== chat.tag,\n    style: {\n      minHeight: '100%'\n    },\n    className: \"fw-bold fs-3 d-flex align-items-center justify-content-center\",\n    children: \"An error has occured\"\n  }, chat.tag, false, {\n    fileName: _jsxFileName,\n    lineNumber: 274,\n    columnNumber: 3\n  }, this);\n  let index = 1;\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      onScroll: unScroll,\n      id: chat.tag,\n      className: \"overflow-auto noScrollBar\",\n      hidden: props.chanTag !== chat.tag,\n      style: {\n        maxHeight: '100%'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-primary\",\n        children: [\"Welcome on the \", chat.name, \" chan\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 284,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-primary\",\n        children: \"Type /h for help\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 5\n      }, this), chat.messages.map(message => {\n        if (message.type === 'help') return /*#__PURE__*/_jsxDEV(Help, {}, index++, false, {\n          fileName: _jsxFileName,\n          lineNumber: 288,\n          columnNumber: 14\n        }, this);\n        if (message.type === 'mute') return /*#__PURE__*/_jsxDEV(MuteList, {\n          props: props\n        }, index++, false, {\n          fileName: _jsxFileName,\n          lineNumber: 290,\n          columnNumber: 14\n        }, this);\n        if (message.type === 'block') return /*#__PURE__*/_jsxDEV(BlockList, {\n          props: props\n        }, index++, false, {\n          fileName: _jsxFileName,\n          lineNumber: 292,\n          columnNumber: 14\n        }, this);\n        if ((message.type === 'whisp' || message.type === 'message') && !props.muted.includes(message.id) && props.myProfile && !props.myProfile.blocked.includes(message.id)) return /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: buildMenu,\n            \"data-id\": message.id,\n            \"data-name\": message.name,\n            type: \"button\",\n            \"data-bs-toggle\": \"dropdown\",\n            className: `nav-link d-inline ${props.myProfile && props.myProfile.id === message.myId ? 'text-danger' : 'text-primary'}`,\n            disabled: props.myProfile && props.myProfile.id === message.myId,\n            children: [props.myProfile && props.myProfile.myId === message.id ? 'You' : message.name, \" \", message.type === 'whisp' && props.myProfile && message.myId === props.myProfile.id && ' to ' + message.target]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 8\n          }, this), ' :', \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: message.type === 'whisp' ? '#107553' : '#000000'\n            },\n            children: [\" \", message.text]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 299,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n            className: \"dropdown-menu\",\n            style: {\n              backgroundColor: '#D8D8D8'\n            },\n            children: menu\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 300,\n            columnNumber: 8\n          }, this)]\n        }, index++, true, {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 7\n        }, this);\n        if (message.type === 'system' || message.type === 'admin') return /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            color: message.type === 'system' ? '#FF0000' : '#5E00FF'\n          },\n          children: message.text\n        }, index++, false, {\n          fileName: _jsxFileName,\n          lineNumber: 303,\n          columnNumber: 14\n        }, this);else return undefined;\n      })]\n    }, chat.tag, true, {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-flex align-items-center justify-content-center my-2\",\n      hidden: props.chanName !== chat.name,\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: toBottom,\n        type: \"button\",\n        className: \"nav-link\",\n        hidden: props.chanName !== chat.name,\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: \"/images/arrow-down-circle.svg\",\n          alt: \"\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 310,\n          columnNumber: 6\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"hr\", {\n      className: \"mx-5 mt-0 mb-2\",\n      hidden: props.chanName !== chat.name\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 10\n    }, this)]\n  }, void 0, true);\n}\n_s2(Channel, \"QQajsfxs3jd5NnTLlYSmO1VeX2Q=\");\n_c3 = Channel;\nexport default Chat;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"Chat\");\n$RefreshReg$(_c2, \"Menu\");\n$RefreshReg$(_c3, \"Channel\");","map":{"version":3,"names":["useState","useEffect","Help","MuteList","BlockList","jsxDEV","_jsxDEV","Fragment","_Fragment","Chat","props","getWhisp","text","undefined","nameStart","indexOf","nameEnd","name","substring","trim","txt","substr","type","target","myId","myProfile","id","isSpecialCommand","command","setChats","chats","map","chat","tag","chanTag","messages","filter","message","document","getElementById","value","sendMessage","prompt","toggleChan","e","setChanTag","dataset","setChanName","leaveChan","captureKey","keyCode","chanIndex","leaveIndex","className","xlg","style","width","maxHeight","children","fileName","_jsxFileName","lineNumber","columnNumber","chanName","length","src","alt","onClick","hidden","maxWidth","Channel","onKeyDown","placeholder","disabled","_c","Menu","_s","profile","setProfile","xhr","XMLHttpRequest","open","onreadystatechange","readyState","status","JSON","parse","response","send","seeProfile","setProfileId","setPage","directMessage","concat","focus","mute","setMuted","muted","addFriend","setMyProfile","friends","unfriend","friend","index","menu","push","includes","challenged","_c2","_s2","setMenu","interval","setInterval","autoScroll","scrollTop","scrollHeight","clearInterval","unScroll","item","toBottom","buildMenu","parseInt","minHeight","onScroll","blocked","color","backgroundColor","_c3","$RefreshReg$"],"sources":["/home/node/app/src/Chat.jsx"],"sourcesContent":["import { useState, useEffect } from \"react\"\nimport { Help, MuteList, BlockList } from \"./other\"\n\nfunction Chat({ props }) {\n\n\tconst getWhisp = (text) => {\n\t\tif (!text[2] || text[2] !== ' ')\n\t\t\treturn undefined\n\t\tlet nameStart = text.indexOf('\"', 3)\n\t\tif (nameStart < 0)\n\t\t\treturn undefined\n\t\tlet nameEnd = text.indexOf('\"', nameStart + 1)\n\t\tif (nameEnd < 0)\n\t\t\treturn undefined\n\t\tlet name = text.substring(nameStart + 1, nameEnd)\n\t\tif (name.trim() === '')\n\t\t\treturn undefined\n\t\tif (!text[nameEnd + 1] || text[nameEnd + 1] !== ' ')\n\t\t\treturn undefined\n\t\tlet txt = text.substr(nameEnd + 2)\n\t\tif (txt.trim() === '')\n\t\t\treturn undefined\n\t\treturn {\n\t\t\ttype : 'whisp',\n\t\t\ttarget : name,\n\t\t\tmyId : props.myProfile.id,\n\t\t\tname : props.myProfile.name,\n\t\t\ttext : txt\n\t\t}\n\t}\n\n\tconst isSpecialCommand = (text) => {\n\t\tlet command = text.substr(0, 2)\n\t\tif (command === '/h' || command === '/m' || command === '/b') {\n\t\t\tif (text[2] && text.substr(2).trim() !== command)\n\t\t\t\tprops.setChats(props.chats.map(chat => {\n\t\t\t\t\tif (chat.tag === props.chanTag)\n\t\t\t\t\t\treturn {...chat, messages : [...chat.messages, {type : 'system', text : 'Wrong command. Use : ' + command}]}\n\t\t\t\t\telse\n\t\t\t\t\t\treturn chat\n\t\t\t\t}))\n\t\t\telse if (command === '/h')\n\t\t\t\tprops.setChats(props.chats.map(chat => {\n\t\t\t\t\tif (chat.tag === props.chanTag)\n\t\t\t\t\t\treturn {...chat, messages : [...chat.messages.filter(message => message.type !== 'help'), {type : 'help'}]}\n\t\t\t\t\telse\n\t\t\t\t\t\treturn chat\n\t\t\t\t}))\n\t\t\telse if (command === '/m')\n\t\t\t\tprops.setChats(props.chats.map(chat => {\n\t\t\t\t\tif (chat.tag === props.chanTag)\n\t\t\t\t\t\treturn {...chat, messages : [...chat.messages.filter(message => message.type !== 'mute'), {type : 'mute'}]}\n\t\t\t\t\telse\n\t\t\t\t\t\treturn chat\n\t\t\t\t}))\n\t\t\telse if (command === '/b')\n\t\t\t\tprops.setChats(props.chats.map(chat => {\n\t\t\t\t\tif (chat.tag === props.chanTag)\n\t\t\t\t\t\treturn {...chat, messages : [...chat.messages.filter(message => message.type !== 'block'), {type : 'block'}]}\n\t\t\t\t\telse\n\t\t\t\t\t\treturn chat\n\t\t\t\t}))\n\t\t\tdocument.getElementById('chatPrompt').value = ''\n\t\t\treturn true\n\t\t}\n\t\tif (command === '/w') {\n\t\t\tlet message = getWhisp(text)\n\t\t\tif (!message) {\n\t\t\t\tprops.setChats(props.chats.map(chat => {\n\t\t\t\t\tif (chat.tag === props.chanTag)\n\t\t\t\t\t\treturn {...chat, messages : [...chat.messages, {type : 'system', text : 'Wrong command. Use : /w \"[username]\" [message]'}]}\n\t\t\t\t\telse\n\t\t\t\t\t\treturn chat\n\t\t\t\t}))\n\t\t\t\tdocument.getElementById('chatPrompt').value = ''\n\t\t\t}\n\t\t\telse {\n\t\t\t\tprops.setChats(props.chats.map(chat => { return {...chat, messages : [...chat.messages, {...message, id : props.myProfile.id}]}}))\n\t\t\t\t// console.log(message.target)\n\t\t\t\tdocument.getElementById('chatPrompt').value = '/w \"' + message.target + '\" '\n\t\t\t}\n\t\t\t//sendMessage\n\t\t\treturn true\n\t\t}\n\t\treturn false\n\t}\n\n    const sendMessage = () => {\n\t\tlet prompt = document.getElementById('chatPrompt').value\n\t\tif (!isSpecialCommand(prompt)) {\n\t\t\tlet message = {\n\t\t\t\ttype : 'message',\n\t\t\t\ttarget : props.chanTag,\n\t\t\t\tmyId : props.myProfile.id,\n\t\t\t\tname : props.myProfile.name,\n\t\t\t\ttext : prompt\n\t\t\t}\n\t\t\t//sendMessage\n\t\t\tprops.setChats(props.chats.map(chat => {\n\t\t\t\tif (chat.tag === props.chanTag)\n\t\t\t\t\treturn {...chat, messages : [...chat.messages, message]}\n\t\t\t\telse\n\t\t\t\t\treturn chat\n\t\t\t}))\n\t\t\tdocument.getElementById('chatPrompt').value = ''\n\t\t}\n    }\n\n\tconst toggleChan = (e) => {\n\t\tprops.setChanTag(e.target.dataset.tag)\n\t\tprops.setChanName(e.target.dataset.name)\n\t}\n\t\n\tconst leaveChan = (e) => {\n\t\tlet tag = e.target.dataset.tag\n\t\tprops.setChats(props.chats.filter(chat => chat.tag !== tag))\n\t\tif (props.chanTag === tag) {\n\t\t\tprops.setChanTag('lobby')\n\t\t\tprops.setChanName('general')\n\t\t}\n\t}\n    \n\tconst captureKey = (e) => e.keyCode === 13 && sendMessage()\n\n\tlet chanIndex = 1\n\tlet leaveIndex = 1\n\n\treturn (\n        <div className={`h-100 ${props.xlg ? 'bg-dark-subtle' : 'bg-white'} d-flex flex-column`} style={{width: '300px', maxHeight: '100%'}}>\n            <div className=\"d-flex justify-content-center py-2\">\n                <button type='button' className='nav-link' data-bs-toggle='dropdown'><h5 className=\"my-0 text-capitalize\"><i>#</i> {props.chanName} {props.chats.length > 1 && <img src='/images/caret-down-fill.svg' alt='' />}</h5></button>\n\t\t\t\t<ul className='dropdown-menu'>\n\t\t\t\t\t{props.chats.map(chat =>\n\t\t\t\t\t\t<li onClick={toggleChan} key={chat.tag} data-tag={chat.tag} data-name={chat.name} type='button' className='px-2 fw-bold dropdown-item nav-link text-capitalize'>{chat.name}</li>\n\t\t\t\t\t)}\n\t\t\t\t\t{props.chats.length > 1 && <li><hr className=\"dropdown-divider\" /></li>}\n\t\t\t\t\t{props.chats.length > 1 &&\n\t\t\t\t\t\tprops.chats.map(chat =>\n\t\t\t\t\t\t\t<li onClick={leaveChan} key={chanIndex++} data-tag={chat.tag} type='button' className='px-2 fw-bold dropdown-item nav-link text-capitalize' hidden={chat.tag === 'lobby'}>Leave {chat.name}</li>\n\t\t\t\t\t\t)\n\t\t\t\t\t}\n\t\t\t\t</ul>\n            </div>\n            <hr className=\"mx-5 mt-0 mb-2\" />\n            <div className=\"px-2 d-flex flex-column justify-content-end overflow-y-auto flex-grow-1\" style={{maxWidth: '100%'}}>\n\t\t\t\t{props.chats.map(chat => {\n\t\t\t\t\treturn <Channel key={leaveIndex++} props={props} chat={chat} />\n\t\t\t\t})}\n            </div>\n            <div className=\"w-100 ps-4 pe-5 pb-3 pt-2 align-self-end\">\n                <div className=\"d-flex gap-3 pt-1 row ps-3\">\n                    <div className=\"input-group p-0 m-0\">\n                        <span className=\"pt-1 me-2 m-0 border-0\"><img src=\"/images/wechat.svg\" alt=\"\" /></span>\n                        <input onKeyDown={captureKey} type=\"text\" name=\"chatPrompt\" id=\"chatPrompt\" className={`form-control ${props.xlg ? 'border-0' : 'border-1 border-black'} rounded`} placeholder={props.myProfile ? 'Say something nice' : 'Log in to chat'} disabled={!props.myProfile || (props.chats[0].messages.length > 0 && props.chats[0].messages[props.chats[0].messages.length - 1].type === 'error')} />\n                        <button onClick={sendMessage} className=\"pt-1 ms-2 nav-link\" disabled={!props.myProfile || (props.chats[0].messages.length > 0 && props.chats[0].messages[props.chats[0].messages.length - 1].type === 'error')}><img src=\"/images/send.svg\" alt=\"\" /></button>\n                      </div>                              \n                </div>\n            </div>\n        </div>\n    )\n}\n\nfunction Menu({props, id, name}) {\n\n\tconst [profile, setProfile] = useState(undefined)\n\n\tif (!profile || profile.id !== id) {\n\t\tlet xhr = new XMLHttpRequest()\n\t\txhr.open('GET', '/aapi/user/' + id + '.json')\n\t\txhr.onreadystatechange = () => {\n\t\t\tif (xhr.readyState === 3)\n\t\t\t\tsetProfile({id : id, status : JSON.parse(xhr.response).profile.status})\n\t\t}\n\t\txhr.send()\n\t\treturn undefined\n\t}\n\n\tconst seeProfile = () => {\n\t\tprops.setProfileId(id)\n\t\tprops.setPage('Profile')\n\t}\n\n\tconst directMessage = () => {\n        let prompt = document.getElementById('chatPrompt')\n        prompt.value = '/w '.concat('\"', name, '\" ')\n        prompt.focus()\n    }\n\n\tconst mute = () => props.setMuted([...props.muted, id])\n\n\tconst addFriend = () => {\n\t\t// var request = new XMLHttpRequest()\n\t\t// request.responseType = 'json'\n\t\t// request.open('POST', '/api/user/' + props.myProfile.id + '/addFriend/' + id, true, props.creds.name, props.creds.password)\n\t\t// request.send()\n\t\t// request.onload = () => {}\n\t\tprops.setMyProfile({\n\t\t\t...props.myProfile,\n\t\t\tfriends : [...props.myProfile.friends, id]\n\t\t})\n\t}\n\n\tconst unfriend = (e) => {\n\t\t// var request = new XMLHttpRequest()\n\t\t// request.responseType = 'json'\n\t\t// request.open('POST', '/api/user/' + props.myProfile.id + '/removeFriend/' + id, true, props.creds.name, props.creds.password)\n\t\t// request.send()\n\t\t// request.onload = () => {}\n\t\tprops.setMyProfile({\n\t\t\t...props.myProfile,\n\t\t\tfriends : props.myProfile.friends.filter(friend => friend !== id)\n\t\t})\n\t}\n\n\tlet index = 1\n\tlet menu = [\n\t\t<li key={index++} className='px-2'>{name}</li>,\n\t\t<li key={index++}><hr className=\"dropdown-divider\" /></li>,\n\t\t<li key={index++} onClick={seeProfile} type='button' className='px-2 dropdown-item nav-link'>See profile</li>\n\t]\n\n\tif (props.myProfile) {\n\t\tmenu.push(<li onClick={mute} key={index++} type='button' className='px-2 dropdown-item nav-link'>Mute</li>)\n\t\tif (!props.myProfile.friends.includes(id))\n\t\t\tmenu.push(<li onClick={addFriend} key={index++} type='button' className='px-2 dropdown-item nav-link'>Add to friendlist</li>)\n\t\telse\n\t\t\tmenu.push(<li onClick={unfriend} key={index++} type='button' className='px-2 dropdown-item nav-link'>Remove from friendlist</li>)\n\t\tif (profile.status === 'online') {\n\t\t\tmenu.push(<li onClick={directMessage} key={index++} type='button' className='px-2 dropdown-item nav-link'>Direct message</li>)\n\t\t\tif (!props.myProfile['pong'].challenged.includes(id))\n\t\t\t\tmenu.push(<li key={index++} type='button' className='px-2 dropdown-item nav-link'>Challenge to Pong</li>)\n\t\t\tif (!props.myProfile['chess'].challenged.includes(id))\n\t\t\t\tmenu.push(<li key={index++} type='button' className='px-2 dropdown-item nav-link'>Challenge to Chess</li>)\n\t\t}\n\t}\t\n\n\treturn menu\n}\n\nexport function Channel({props, chat}) {\n\n\tconst [menu, setMenu] = useState(undefined)\n\n\tuseEffect(() => {\n\t\tconst interval = setInterval(() => {\n\t\t\tif (chat.autoScroll)\n\t\t\t\tdocument.getElementById(chat.tag).scrollTop = document.getElementById(chat.tag).scrollHeight\n\t\t}, 1000)\n\t\treturn () => clearInterval(interval)\n\t})\n\n\tconst unScroll = () => props.setChats(\n\t\tprops.chats.map(item => {\n\t\tif (item.tag === chat.tag)\n\t\t\treturn {...item, autoScroll : false}\n\t\telse\n\t\t\treturn item\n\t\t}))\n\n\tconst toBottom = () => {\n\t\tdocument.getElementById(chat.tag).scrollTop = document.getElementById(chat.tag).scrollHeight\n\t\tprops.chats.map(item => {\n\t\t\tif (item.tag === chat.tag)\n\t\t\t\treturn {...item, autoScroll : true}\n\t\t\telse\n\t\t\t\treturn item\n\t\t})\n\t}\n\n\tconst buildMenu = (e) => setMenu(<Menu props={props} id={parseInt(e.target.dataset.id, 10)} name={e.target.dataset.name} />)\n\n\tif (chat.messages.length > 0 && chat.messages[chat.messages.length - 1].type === 'error')\n\t\treturn (\n\t\t<div key={chat.tag} hidden={props.chanTag !== chat.tag} style={{minHeight: '100%'}} className='fw-bold fs-3 d-flex align-items-center justify-content-center'>\n\t\t\tAn error has occured\n\t\t</div>\n\t\t)\n\n\tlet index = 1\n\n\treturn (\n\t\t<>\n\t\t\t<div onScroll={unScroll} id={chat.tag} key={chat.tag} className='overflow-auto noScrollBar' hidden={props.chanTag !== chat.tag} style={{maxHeight: '100%'}}>\n\t\t\t\t<div className='text-primary'>Welcome on the {chat.name} chan</div>\n\t\t\t\t<div className=\"text-primary\">Type /h for help</div>\n\t\t\t\t{chat.messages.map(message => {\n\t\t\t\t\tif (message.type === 'help')\n\t\t\t\t\t\treturn <Help key={index++} />\n\t\t\t\t\tif (message.type === 'mute')\n\t\t\t\t\t\treturn <MuteList key={index++} props={props} />\n\t\t\t\t\tif (message.type === 'block')\n\t\t\t\t\t\treturn <BlockList key={index++} props={props} />\n\t\t\t\t\tif ((message.type === 'whisp' || message.type === 'message') && !props.muted.includes(message.id) && props.myProfile && !props.myProfile.blocked.includes(message.id))\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t<div key={index++}>\n\t\t\t\t\t\t\t<button onClick={buildMenu} data-id={message.id} data-name={message.name} type='button' data-bs-toggle='dropdown' className={`nav-link d-inline ${props.myProfile && props.myProfile.id === message.myId ? 'text-danger' : 'text-primary'}`} disabled={props.myProfile && props.myProfile.id === message.myId}>\n\t\t\t\t\t\t\t\t{props.myProfile && props.myProfile.myId === message.id ? 'You' : message.name} {message.type === 'whisp' && props.myProfile && message.myId === props.myProfile.id && ' to ' + message.target}\n\t\t\t\t\t\t\t</button> \n\t\t\t\t\t\t\t{' :'} <span style={{color : message.type === 'whisp' ? '#107553' : '#000000'}}> {message.text}</span>\n\t\t\t\t\t\t\t<ul className='dropdown-menu' style={{backgroundColor: '#D8D8D8'}}>{menu}</ul>\n\t\t\t\t\t\t</div>)\n\t\t\t\t\tif (message.type === 'system' || message.type === 'admin')\n\t\t\t\t\t\treturn <div key={index++} style={{color : message.type === 'system' ? '#FF0000' : '#5E00FF'}}>{message.text}</div>\n\t\t\t\t\telse\n\t\t\t\t\t\treturn undefined\n\t\t\t\t})}\n\t\t\t</div>\n\t\t\t<div className='d-flex align-items-center justify-content-center my-2' hidden={props.chanName !== chat.name}>\n\t\t\t\t<button onClick={toBottom} type='button' className='nav-link' hidden={props.chanName !== chat.name}>\n\t\t\t\t\t<img src=\"/images/arrow-down-circle.svg\" alt=\"\" />\n\t\t\t\t</button>\n\t\t\t</div>\n        \t<hr className=\"mx-5 mt-0 mb-2\" hidden={props.chanName !== chat.name} />\n\t\t</>\n\t)\n}\n\nexport default Chat"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}